!function(){var a=null,b={inheritAttrs:function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]instanceof Object&&b[c]instanceof Object&&"function"!=typeof b[c]?this.inheritAttrs(a[c],b[c]):a[c]=b[c])},createMerge:function(a,b){var c={};return a&&this.inheritAttrs(c,this.cloneObj(a)),b&&this.inheritAttrs(c,b),c},extend:function(){return a?(Array.prototype.unshift.apply(arguments,[!0,{}]),a.extend.apply(a,arguments)):b.createMerge.apply(this,arguments)},cloneObj:function(a){if(Object(a)!==a)return a;var b=new a.constructor;for(var c in a)a.hasOwnProperty(c)&&(b[c]=this.cloneObj(a[c]));return b},addEvent:function(b,c,d){a?a(b).on(c+".treant",d):b.addEventListener?b.addEventListener(c,d,!1):b.attachEvent?b.attachEvent("on"+c,d):b["on"+c]=d},findEl:function(b,c,d){if(d=d||document,a){var e=a(b,d);return c?e.get(0):e}if("#"==b.charAt(0))return d.getElementById(b.substring(1));if("."==b.charAt(0)){var f=d.getElementsByClassName(b.substring(1));return f.length?f[0]:null}throw new Error("Unknown container element")},getOuterHeight:function(c){var d=1;return"function"==typeof c.getBoundingClientRect?c.getBoundingClientRect().height:a?Math.ceil(a(c).outerHeight())+d:Math.ceil(c.clientHeight+b.getStyle(c,"border-top-width",!0)+b.getStyle(c,"border-bottom-width",!0)+b.getStyle(c,"padding-top",!0)+b.getStyle(c,"padding-bottom",!0)+d)},getOuterWidth:function(c){var d=1;return"function"==typeof c.getBoundingClientRect?c.getBoundingClientRect().width:a?Math.ceil(a(c).outerWidth())+d:Math.ceil(c.clientWidth+b.getStyle(c,"border-left-width",!0)+b.getStyle(c,"border-right-width",!0)+b.getStyle(c,"padding-left",!0)+b.getStyle(c,"padding-right",!0)+d)},getStyle:function(a,b,c){var d="";return document.defaultView&&document.defaultView.getComputedStyle?d=document.defaultView.getComputedStyle(a,"").getPropertyValue(b):a.currentStyle&&(b=b.replace(/\-(\w)/g,function(a,b){return b.toUpperCase()}),d=a.currentStyle[b]),c?parseFloat(d):d},addClass:function(c,d){a?a(c).addClass(d):b.hasClass(c,d)||(c.classList?c.classList.add(d):c.className+=" "+d)},hasClass:function(a,b){return(" "+a.className+" ").replace(/[\n\t]/g," ").indexOf(" "+b+" ")>-1},toggleClass:function(b,c,d){a?a(b).toggleClass(c,d):d?b.classList.add(c):b.classList.remove(c)},setDimensions:function(b,c,d){a?a(b).width(c).height(d):(b.style.width=c+"px",b.style.height=d+"px")}},c=function(){this.reset()};c.prototype={reset:function(){return this.loading=[],this},processNode:function(a){for(var b=a.nodeDOM.getElementsByTagName("img"),c=b.length;c--;)this.create(a,b[c]);return this},removeAll:function(a){for(var b=this.loading.length;b--;)this.loading[b]===a&&this.loading.splice(b,1);return this},create:function(a,c){function f(){d.removeAll(e),a.width=a.nodeDOM.offsetWidth,a.height=a.nodeDOM.offsetHeight}var d=this,e=c.src;if(0!==c.src.indexOf("data:")){if(this.loading.push(e),c.complete)return f();b.addEvent(c,"load",f),b.addEvent(c,"error",f),c.src+="?"+(new Date).getTime()}else f()},isNotLoading:function(){return 0===this.loading.length}};var d={store:[],createTree:function(a){var b=this.store.length;return this.store.push(new e(a,b)),this.get(b)},get:function(a){return this.store[a]},destroy:function(a){var b=this.get(a);if(b){b._R.remove();for(var c=b.drawArea;c.firstChild;)c.removeChild(c.firstChild);for(var d=c.className.split(" "),e=[],f=0;f<d.length;f++){var g=d[f];"Treant"!=g&&"Treant-loaded"!=g&&e.push(g)}c.style.overflowY="",c.style.overflowX="",c.className=e.join(" "),this.store[a]=null}return this}},e=function(a,d){this.reset=function(a,d){if(this.initJsonConfig=a,this.initTreeId=d,this.id=d,this.CONFIG=b.extend(e.CONFIG,a.chart),this.drawArea=b.findEl(this.CONFIG.container,!0),!this.drawArea)throw new Error('Failed to find element by selector "'+selector+'"');return b.addClass(this.drawArea,"Treant"),this.drawArea.innerHTML="",this.imageLoader=new c,this.nodeDB=new f(a.nodeStructure,this),this.connectionStore={},this.loaded=!1,this._R=new Raphael(this.drawArea,100,100),this},this.reload=function(){return this.reset(this.initJsonConfig,this.initTreeId).redraw(),this},this.reset(a,d)};e.prototype={getNodeDb:function(){return this.nodeDB},addNode:function(a,b){this.nodeDB.get(a.id);this.CONFIG.callback.onBeforeAddNode.apply(this,[a,b]);var d=this.nodeDB.createNode(b,a.id,this);return d.createGeometry(this),d.parent().createSwitchGeometry(this),this.positionTree(),this.CONFIG.callback.onAfterAddNode.apply(this,[d,a,b]),d},redraw:function(){return this.positionTree(),this},positionTree:function(a){var c=this;if(this.imageLoader.isNotLoading()){var d=this.root();this.CONFIG.rootOrientation;this.resetLevelData(),this.firstWalk(d,0),this.secondWalk(d,0,0,0),this.positionNodes(),this.CONFIG.animateOnInit&&setTimeout(function(){d.toggleCollapse()},this.CONFIG.animateOnInitDelay),this.loaded||(b.addClass(this.drawArea,"Treant-loaded"),"[object Function]"===Object.prototype.toString.call(a)&&a(c),c.CONFIG.callback.onTreeLoaded.apply(c,[d]),this.loaded=!0)}else setTimeout(function(){c.positionTree(a)},10);return this},firstWalk:function(a,b){a.prelim=null,a.modifier=null,this.setNeighbors(a,b),this.calcLevelDim(a,b);var c=a.leftSibling();if(0===a.childrenCount()||b==this.CONFIG.maxDepth)c?a.prelim=c.prelim+c.size()+this.CONFIG.siblingSeparation:a.prelim=0;else{for(var d=0,e=a.childrenCount();d<e;d++)this.firstWalk(a.childAt(d),b+1);var f=a.childrenCenter()-a.size()/2;c?(a.prelim=c.prelim+c.size()+this.CONFIG.siblingSeparation,a.modifier=a.prelim-f,this.apportion(a,b)):a.prelim=f,a.stackParent?a.modifier+=this.nodeDB.get(a.stackChildren[0]).size()/2+a.connStyle.stackIndent:a.stackParentId&&(a.prelim=0)}return this},apportion:function(a,b){for(var c=a.firstChild(),d=c.leftNeighbor(),e=1,f=this.CONFIG.maxDepth-b;c&&d&&e<=f;){for(var g=0,h=0,i=d,j=c,k=0;k<e;k++)i=i.parent(),j=j.parent(),h+=i.modifier,g+=j.modifier,void 0!==j.stackParent&&(g+=j.size()/2);var l=d.prelim+h+d.size()+this.CONFIG.subTeeSeparation-(c.prelim+g);if(l>0){for(var m=a,n=0;m&&m.id!=i.id;)m=m.leftSibling(),n++;if(m)for(var o=a,p=l/n;o.id!=i.id;)o.prelim+=l,o.modifier+=l,l-=p,o=o.leftSibling()}e++,c=0===c.childrenCount()?a.leftMost(0,e):c=c.firstChild(),c&&(d=c.leftNeighbor())}},secondWalk:function(a,b,c,d){if(b<=this.CONFIG.maxDepth){var i,j,e=a.prelim+c,f=d,g=this.CONFIG.nodeAlign,h=this.CONFIG.rootOrientation;if("NORTH"==h||"SOUTH"==h?(i=this.levelMaxDim[b].height,j=a.height,a.pseudo&&(a.height=i)):"WEST"!=h&&"EAST"!=h||(i=this.levelMaxDim[b].width,j=a.width,a.pseudo&&(a.width=i)),a.X=e,a.pseudo?"NORTH"==h||"WEST"==h?a.Y=f:"SOUTH"!=h&&"EAST"!=h||(a.Y=f+(i-j)):a.Y="CENTER"==g?f+(i-j)/2:"TOP"==g?f+(i-j):f,"WEST"==h||"EAST"==h){var k=a.X;a.X=a.Y,a.Y=k}"SOUTH"==h?a.Y=-a.Y-j:"EAST"==h&&(a.X=-a.X-j),0!==a.childrenCount()&&(0===a.id&&this.CONFIG.hideRootNode?this.secondWalk(a.firstChild(),b+1,c+a.modifier,d):this.secondWalk(a.firstChild(),b+1,c+a.modifier,d+i+this.CONFIG.levelSeparation)),a.rightSibling()&&this.secondWalk(a.rightSibling(),b,c,d)}},positionNodes:function(){var a=this,b={x:a.nodeDB.getMinMaxCoord("X",null,null),y:a.nodeDB.getMinMaxCoord("Y",null,null)},c=b.x.max-b.x.min,d=b.y.max-b.y.min,e={x:b.x.max-c/2,y:b.y.max-d/2};this.handleOverflow(c,d);var k,l,m,f={x:a.drawArea.clientWidth/2,y:a.drawArea.clientHeight/2},g=f.x-e.x,h=f.y-e.y,i=b.x.min+g<=0?Math.abs(b.x.min):0,j=b.y.min+h<=0?Math.abs(b.y.min):0;for(k=0,l=this.nodeDB.db.length;k<l;k++)if(m=this.nodeDB.get(k),a.CONFIG.callback.onBeforePositionNode.apply(a,[m,k,f,e]),0===m.id&&this.CONFIG.hideRootNode)a.CONFIG.callback.onAfterPositionNode.apply(a,[m,k,f,e]);else{m.X+=i+(c<this.drawArea.clientWidth?g:this.CONFIG.padding),m.Y+=j+(d<this.drawArea.clientHeight?h:this.CONFIG.padding);var n=m.collapsedParent(),o=null;n?(o=n.connectorPoint(!0),m.hide(o)):m.positioned?m.show():(m.nodeDOM.style.left=m.X+"px",m.nodeDOM.style.top=m.Y+"px",m.positioned=!0),0===m.id||0===m.parent().id&&this.CONFIG.hideRootNode?!this.CONFIG.hideRootNode&&m.drawLineThrough&&m.drawLineThroughMe():this.setConnectionToParent(m,o),a.CONFIG.callback.onAfterPositionNode.apply(a,[m,k,f,e])}return this},handleOverflow:function(c,d){var e=c<this.drawArea.clientWidth?this.drawArea.clientWidth:c+2*this.CONFIG.padding,f=d<this.drawArea.clientHeight?this.drawArea.clientHeight:d+2*this.CONFIG.padding;if(this._R.setSize(e,f),"resize"==this.CONFIG.scrollbar)b.setDimensions(this.drawArea,e,f);else if(void 0==a||"native"==this.CONFIG.scrollbar)this.drawArea.clientWidth<c&&(this.drawArea.style.overflowX="auto"),this.drawArea.clientHeight<d&&(this.drawArea.style.overflowY="auto");else if("fancy"==this.CONFIG.scrollbar){var g=a(this.drawArea);if(g.hasClass("ps-container"))g.find(".Treant").css({width:e,height:f}),g.perfectScrollbar("update");else{var h=g.wrapInner('<div class="Treant"/>'),i=h.find(".Treant");i.css({width:e,height:f}),h.perfectScrollbar()}}return this},setConnectionToParent:function(a,b){var d,c=a.stackParentId,e=c?this.nodeDB.get(c):a.parent(),f=b?this.getPointPathString(b):this.getPathString(e,a,c);return this.connectionStore[a.id]?(d=this.connectionStore[a.id],this.animatePath(d,f)):(d=this._R.path(f),this.connectionStore[a.id]=d,a.pseudo&&delete e.connStyle.style["arrow-end"],e.pseudo&&delete e.connStyle.style["arrow-start"],d.attr(e.connStyle.style),(a.drawLineThrough||a.pseudo)&&a.drawLineThroughMe(b)),a.connector=d,this},getPointPathString:function(a){return["_M",a.x,",",a.y,"L",a.x,",",a.y,a.x,",",a.y].join(" ")},animatePath:function(a,b){return a.hidden&&"_"!==b.charAt(0)&&(a.show(),a.hidden=!1),a.animate({path:"_"===b.charAt(0)?b.substring(1):b},this.CONFIG.animation.connectorsSpeed,this.CONFIG.animation.connectorsAnimation,function(){"_"===b.charAt(0)&&(a.hide(),a.hidden=!0)}),this},getPathString:function(a,b,c){var d=a.connectorPoint(!0),e=b.connectorPoint(!1),f=this.CONFIG.rootOrientation,g=a.connStyle.type,h={},i={};"NORTH"==f||"SOUTH"==f?(h.y=i.y=(d.y+e.y)/2,h.x=d.x,i.x=e.x):"EAST"!=f&&"WEST"!=f||(h.x=i.x=(d.x+e.x)/2,h.y=d.y,i.y=e.y);var o,p,j=d.x+","+d.y,k=h.x+","+h.y,l=i.x+","+i.y,m=e.x+","+e.y,n=(h.x+i.x)/2+","+(h.y+i.y)/2;if(c){if(p="EAST"==f||"WEST"==f?e.x+","+d.y:d.x+","+e.y,"step"==g||"straight"==g)o=["M",j,"L",p,"L",m];else if("curve"==g||"bCurve"==g){var q,r=a.connStyle.stackIndent;"NORTH"==f?q=e.x-r+","+(e.y-r):"SOUTH"==f?q=e.x-r+","+(e.y+r):"EAST"==f?q=e.x+r+","+d.y:"WEST"==f&&(q=e.x-r+","+d.y),o=["M",j,"L",q,"S",p,m]}}else"step"==g?o=["M",j,"L",k,"L",l,"L",m]:"curve"==g?o=["M",j,"C",k,l,m]:"bCurve"==g?o=["M",j,"Q",k,n,"T",m]:"straight"==g&&(o=["M",j,"L",j,m]);return o.join(" ")},setNeighbors:function(a,b){return a.leftNeighborId=this.lastNodeOnLevel[b],a.leftNeighborId&&(a.leftNeighbor().rightNeighborId=a.id),this.lastNodeOnLevel[b]=a.id,this},calcLevelDim:function(a,b){return this.levelMaxDim[b]={width:Math.max(this.levelMaxDim[b]?this.levelMaxDim[b].width:0,a.width),height:Math.max(this.levelMaxDim[b]?this.levelMaxDim[b].height:0,a.height)},this},resetLevelData:function(){return this.lastNodeOnLevel=[],this.levelMaxDim=[],this},root:function(){return this.nodeDB.get(0)}};var f=function(a,b){this.reset(a,b)};f.prototype={reset:function(a,c){function e(a,f){var g=d.createNode(a,f,c,null);if(a.children){if(a.childrenDropLevel&&a.childrenDropLevel>0)for(;a.childrenDropLevel--;){var h=b.cloneObj(g.connStyle);g=d.createNode("pseudo",g.id,c,null),g.connStyle=h,g.children=[]}var i=a.stackChildren&&!d.hasGrandChildren(a)?g.id:null;null!==i&&(g.stackChildren=[]);for(var j=0,k=a.children.length;j<k;j++)null!==i?(g=d.createNode(a.children[j],g.id,c,i),j+1<k&&(g.children=[])):e(a.children[j],g.id)}}this.db=[];var d=this;return c.CONFIG.animateOnInit&&(a.collapsed=!0),e(a,-1),this.createGeometries(c),this},createGeometries:function(a){for(var b=this.db.length;b--;)this.get(b).createGeometry(a);return this},get:function(a){return this.db[a]},walk:function(a){for(var b=this.db.length;b--;)a.apply(this,[this.get(b)]);return this},createNode:function(a,b,c,d){var e=new g(a,this.db.length,b,c,d);if(this.db.push(e),b>=0){var f=this.get(b);if(a.position)if("left"==a.position)f.children.push(e.id);else if("right"==a.position)f.children.splice(0,0,e.id);else if("center"==a.position)f.children.splice(Math.floor(f.children.length/2),0,e.id);else{var h=parseInt(a.position);1==f.children.length&&h>0?f.children.splice(0,0,e.id):f.children.splice(Math.max(h,f.children.length-1),0,e.id)}else f.children.push(e.id)}return d&&(this.get(d).stackParent=!0,this.get(d).stackChildren.push(e.id)),e},getMinMaxCoord:function(a,b,c){b=b||this.get(0),c=c||{min:b[a],max:b[a]+("X"==a?b.width:b.height)};for(var d=b.childrenCount();d--;){var e=b.childAt(d),f=e[a]+("X"==a?e.width:e.height),g=e[a];f>c.max&&(c.max=f),g<c.min&&(c.min=g),this.getMinMaxCoord(a,e,c)}return c},hasGrandChildren:function(a){for(var b=a.children.length;b--;)if(a.children[b].children)return!0;return!1}};var g=function(a,b,c,d,e){this.reset(a,b,c,d,e)};g.prototype={reset:function(a,c,d,e,f){return this.id=c,this.parentId=d,this.treeId=e.id,this.prelim=0,this.modifier=0,this.leftNeighborId=null,this.stackParentId=f,this.pseudo="pseudo"===a||a.pseudo,this.meta=a.meta||{},this.image=a.image||null,this.link=b.createMerge(e.CONFIG.node.link,a.link),this.connStyle=b.createMerge(e.CONFIG.connectors,a.connectors),this.connector=null,this.drawLineThrough=a.drawLineThrough!==!1&&(a.drawLineThrough||e.CONFIG.node.drawLineThrough),this.collapsable=a.collapsable!==!1&&(a.collapsable||e.CONFIG.node.collapsable),this.collapsed=a.collapsed,this.text=a.text,this.nodeInnerHTML=a.innerHTML,this.nodeHTMLclass=(e.CONFIG.node.HTMLclass?e.CONFIG.node.HTMLclass:"")+(a.HTMLclass?" "+a.HTMLclass:""),this.nodeHTMLid=a.HTMLid,this.children=[],this},getTree:function(){return d.get(this.treeId)},getTreeConfig:function(){return this.getTree().CONFIG},getTreeNodeDb:function(){return this.getTree().getNodeDb()},lookupNode:function(a){return this.getTreeNodeDb().get(a)},Tree:function(){return d.get(this.treeId)},dbGet:function(a){return this.getTreeNodeDb().get(a)},size:function(){var a=this.getTreeConfig().rootOrientation;return this.pseudo?-this.getTreeConfig().subTeeSeparation:"NORTH"==a||"SOUTH"==a?this.width:"WEST"==a||"EAST"==a?this.height:void 0},childrenCount:function(){return this.collapsed||!this.children?0:this.children.length},childAt:function(a){return this.dbGet(this.children[a])},firstChild:function(){return this.childAt(0)},lastChild:function(){return this.childAt(this.children.length-1)},parent:function(){return this.lookupNode(this.parentId)},leftNeighbor:function(){if(this.leftNeighborId)return this.lookupNode(this.leftNeighborId)},rightNeighbor:function(){if(this.rightNeighborId)return this.lookupNode(this.rightNeighborId)},leftSibling:function(){var a=this.leftNeighbor();if(a&&a.parentId==this.parentId)return a},rightSibling:function(){var a=this.rightNeighbor();if(a&&a.parentId==this.parentId)return a},childrenCenter:function(){var a=this.firstChild(),b=this.lastChild();return a.prelim+(b.prelim-a.prelim+b.size())/2},collapsedParent:function(){var a=this.parent();return!!a&&(a.collapsed?a:a.collapsedParent())},leftMost:function(a,b){if(a>=b)return this;if(0!==this.childrenCount())for(var c=0,d=this.childrenCount();c<d;c++){var e=this.childAt(c).leftMost(a+1,b);if(e)return e}},connectorPoint:function(a){var b=this.Tree().CONFIG.rootOrientation,c={};return this.stackParentId&&("NORTH"==b||"SOUTH"==b?b="WEST":"EAST"!=b&&"WEST"!=b||(b="NORTH")),"NORTH"==b?(c.x=this.pseudo?this.X-this.Tree().CONFIG.subTeeSeparation/2:this.X+this.width/2,c.y=a?this.Y+this.height:this.Y):"SOUTH"==b?(c.x=this.pseudo?this.X-this.Tree().CONFIG.subTeeSeparation/2:this.X+this.width/2,c.y=a?this.Y:this.Y+this.height):"EAST"==b?(c.x=a?this.X:this.X+this.width,c.y=this.pseudo?this.Y-this.Tree().CONFIG.subTeeSeparation/2:this.Y+this.height/2):"WEST"==b&&(c.x=a?this.X+this.width:this.X,c.y=this.pseudo?this.Y-this.Tree().CONFIG.subTeeSeparation/2:this.Y+this.height/2),c},pathStringThrough:function(){var a=this.connectorPoint(!0),b=this.connectorPoint(!1);return["M",a.x+","+a.y,"L",b.x+","+b.y].join(" ")},drawLineThroughMe:function(a){var c=a?this.Tree().getPointPathString(a):this.pathStringThrough();this.lineThroughMe=this.lineThroughMe||this.Tree()._R.path(c);var d=b.cloneObj(this.connStyle.style);delete d["arrow-start"],delete d["arrow-end"],this.lineThroughMe.attr(d),a&&(this.lineThroughMe.hide(),this.lineThroughMe.hidden=!0)},addSwitchEvent:function(a){var c=this;b.addEvent(a,"click",function(b){return b.preventDefault(),c.getTreeConfig().callback.onBeforeClickCollapseSwitch.apply(c,[a,b])!==!1&&(c.toggleCollapse(),void c.getTreeConfig().callback.onAfterClickCollapseSwitch.apply(c,[a,b]))})},collapse:function(){return this.collapsed||this.toggleCollapse(),this},expand:function(){return this.collapsed&&this.toggleCollapse(),this},toggleCollapse:function(){var a=this.getTree();if(!a.inAnimation){a.inAnimation=!0,this.collapsed=!this.collapsed,b.toggleClass(this.nodeDOM,"collapsed",this.collapsed),a.positionTree();var c=this;setTimeout(function(){a.inAnimation=!1,a.CONFIG.callback.onToggleCollapseFinished.apply(a,[c,c.collapsed])},a.CONFIG.animation.nodeSpeed>a.CONFIG.animation.connectorsSpeed?a.CONFIG.animation.nodeSpeed:a.CONFIG.animation.connectorsSpeed)}return this},hide:function(b){b=b||!1;var c=this.hidden;this.hidden=!0,this.nodeDOM.style.overflow="hidden";var d=this.getTree(),e=this.getTreeConfig(),f={opacity:0};if(b&&(f.left=b.x,f.top=b.y),!this.positioned||c?(this.nodeDOM.style.visibility="hidden",a?a(this.nodeDOM).css(f):(this.nodeDOM.style.left=f.left+"px",this.nodeDOM.style.top=f.top+"px"),this.positioned=!0):a?a(this.nodeDOM).animate(f,e.animation.nodeSpeed,e.animation.nodeAnimation,function(){this.style.visibility="hidden"}):(this.nodeDOM.style.transition="all "+e.animation.nodeSpeed+"ms ease",this.nodeDOM.style.transitionProperty="opacity, left, top",this.nodeDOM.style.opacity=f.opacity,this.nodeDOM.style.left=f.left+"px",this.nodeDOM.style.top=f.top+"px",this.nodeDOM.style.visibility="hidden"),this.lineThroughMe){var g=d.getPointPathString(b);c?this.lineThroughMe.attr({path:g}):d.animatePath(this.lineThroughMe,d.getPointPathString(b))}return this},hideConnector:function(){var a=this.Tree(),b=a.connectionStore[this.id];return b&&b.animate({opacity:0},a.CONFIG.animation.connectorsSpeed,a.CONFIG.animation.connectorsAnimation),this},show:function(){this.hidden;this.hidden=!1,this.nodeDOM.style.visibility="visible";var d=(this.Tree(),{left:this.X,top:this.Y,opacity:1}),e=this.getTreeConfig();return a?a(this.nodeDOM).animate(d,e.animation.nodeSpeed,e.animation.nodeAnimation,function(){this.style.overflow=""}):(this.nodeDOM.style.transition="all "+e.animation.nodeSpeed+"ms ease",this.nodeDOM.style.transitionProperty="opacity, left, top",this.nodeDOM.style.left=d.left+"px",this.nodeDOM.style.top=d.top+"px",this.nodeDOM.style.opacity=d.opacity,this.nodeDOM.style.overflow=""),this.lineThroughMe&&this.getTree().animatePath(this.lineThroughMe,this.pathStringThrough()),this},showConnector:function(){var a=this.Tree(),b=a.connectionStore[this.id];return b&&b.animate({opacity:1},a.CONFIG.animation.connectorsSpeed,a.CONFIG.animation.connectorsAnimation),this}},g.prototype.createGeometry=function(b){if(0===this.id&&b.CONFIG.hideRootNode)return this.width=0,void(this.height=0);var d,c=b.drawArea,e=document.createElement(this.link.href?"a":"div");if(e.className=this.pseudo?"pseudo":g.CONFIG.nodeHTMLclass,this.nodeHTMLclass&&!this.pseudo&&(e.className+=" "+this.nodeHTMLclass),this.nodeHTMLid&&(e.id=this.nodeHTMLid),this.link.href&&(e.href=this.link.href,e.target=this.link.target),a?a(e).data("treenode",this):e.data={treenode:this},!this.pseudo){if(this.nodeInnerHTML)if("#"===this.nodeInnerHTML.charAt(0)){var i=document.getElementById(this.nodeInnerHTML.substring(1));i?(e=i.cloneNode(!0),e.id+="-clone",e.className+=" node"):e.innerHTML="<b> Wrong ID selector </b>"}else e.innerHTML=this.nodeInnerHTML;else if(this.image&&(d=document.createElement("img"),d.src=this.image,e.appendChild(d)),this.text)for(var f in this.text)if(g.CONFIG.textClass[f]){var h=document.createElement(this.text[f].href?"a":"p");this.text[f].href&&(h.href=this.text[f].href,this.text[f].target&&(h.target=this.text[f].target)),h.className=g.CONFIG.textClass[f],h.appendChild(document.createTextNode(this.text[f].val?this.text[f].val:this.text[f]instanceof Object?"'val' param missing!":this.text[f])),e.appendChild(h)}(this.collapsed||this.collapsable&&this.childrenCount()&&!this.stackParentId)&&this.createSwitchGeometry(b,e)}b.CONFIG.callback.onCreateNode.apply(b,[this,e]),c.appendChild(e),this.width=e.offsetWidth,this.height=e.offsetHeight,this.nodeDOM=e,b.imageLoader.processNode(this)},g.prototype.createSwitchGeometry=function(a,c){c=c||this.nodeDOM;var d=b.findEl(".collapse-switch",!0,c);return d||(d=document.createElement("a"),d.className="collapse-switch",c.appendChild(d),this.addSwitchEvent(d),this.collapsed&&(c.className+=" collapsed"),a.CONFIG.callback.onCreateNodeCollapseSwitch.apply(a,[this,c,d])),d},e.CONFIG={maxDepth:100,rootOrientation:"NORTH",nodeAlign:"CENTER",levelSeparation:30,siblingSeparation:30,subTeeSeparation:30,hideRootNode:!1,animateOnInit:!1,animateOnInitDelay:500,padding:15,scrollbar:"native",connectors:{type:"curve",style:{stroke:"black"},stackIndent:15},node:{link:{target:"_self"}},animation:{nodeSpeed:450,nodeAnimation:"linear",connectorsSpeed:450,connectorsAnimation:"linear"},callback:{onCreateNode:function(a,b){},onCreateNodeCollapseSwitch:function(a,b,c){},onAfterAddNode:function(a,b,c){},onBeforeAddNode:function(a,b){},onAfterPositionNode:function(a,b,c,d){},onBeforePositionNode:function(a,b,c,d){},onToggleCollapseFinished:function(a,b){},onAfterClickCollapseSwitch:function(a,b){},onBeforeClickCollapseSwitch:function(a,b){},onTreeLoaded:function(a){}}},g.CONFIG={nodeHTMLclass:"node",textClass:{name:"node-name",title:"node-title",desc:"node-desc",contact:"node-contact"}};var h={make:function(a){var c,b=a.length;for(this.jsonStructure={chart:null,nodeStructure:null};b--;)c=a[b],c.hasOwnProperty("container")?this.jsonStructure.chart=c:c.hasOwnProperty("parent")||c.hasOwnProperty("container")||(this.jsonStructure.nodeStructure=c,c.myID=this.getID());return this.findChildren(a),this.jsonStructure},findChildren:function(a){for(var b=[0];b.length;){for(var c=b.pop(),d=this.findNode(this.jsonStructure.nodeStructure,c),e=0,f=a.length,g=[];e<f;e++){var h=a[e];h.parent&&h.parent.myID==c&&(h.myID=this.getID(),delete h.parent,g.push(h),b.push(h.myID))}g.length&&(d.children=g)}},findNode:function(a,b){var c,d;if(a.myID===b)return a;if(a.children)for(c=a.children.length;c--;)if(d=this.findNode(a.children[c],b))return d},getID:function(){var a=0;return function(){return a++}}()},i=function(b,c,e){b instanceof Array&&(b=h.make(b)),e&&(a=e),this.tree=d.createTree(b),this.tree.positionTree(c)};i.prototype.destroy=function(){d.destroy(this.tree.id)},window.Treant=i}();